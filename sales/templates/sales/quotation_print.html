{% load humanize %}
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ {{ quote.code }}</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Sarabun', sans-serif; 
            background: #525659; /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° PDF */
            margin: 0; 
            padding: 20px;
        }
        
        /* ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4 */
        .page {
            width: 210mm;
            min-height: 297mm;
            padding: 20mm;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
            position: relative;
            box-sizing: border-box; /* ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡πÉ‡∏´‡πâ padding ‡πÑ‡∏°‡πà‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© */
        }

        /* ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß */
        .header { display: flex; justify-content: space-between; margin-bottom: 30px; }
        .company-info h2 { margin: 0 0 5px 0; color: #333; font-weight: bold; }
        .company-info p { margin: 0; color: #555; line-height: 1.4; font-size: 0.95em; }
        
        .doc-title { text-align: right; }
        .doc-title h1 { margin: 0; color: #0d6efd; text-transform: uppercase; font-size: 24pt; }
        .doc-title p { margin: 0; letter-spacing: 2px; color: #777; font-weight: bold; }
        
        /* ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ */
        .info-section { 
            display: flex; justify-content: space-between; 
            margin-bottom: 25px; 
            border-top: 2px solid #333; 
            border-bottom: 2px solid #333; 
            padding: 15px 0;
        }
        .box { width: 48%; font-size: 0.95em; line-height: 1.5; }
        .box strong { color: #000; display: inline-block; width: 100px; }

        /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ */
        .item-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        .item-table th { 
            background: #f0f0f0; border: 1px solid #ccc; padding: 10px; 
            text-align: center; font-weight: bold; 
        }
        .item-table td { 
            border: 1px solid #ccc; padding: 8px; vertical-align: top; 
        }
        .text-right { text-align: right; }
        .text-center { text-align: center; }

        /* ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡πâ‡∏≤‡∏¢ */
        .total-section { display: flex; justify-content: flex-end; margin-top: 10px; }
        .total-box { width: 45%; }
        .total-row { display: flex; justify-content: space-between; padding: 6px 10px; }
        .grand-total { 
            background: #f0f0f0; font-weight: bold; font-size: 1.1em; 
            border: 1px solid #ccc; margin-top: 5px; 
        }

        .signature-section { 
            display: flex; justify-content: space-between; margin-top: 60px; text-align: center; 
        }
        .sig-box { width: 40%; }
        .sig-line { border-bottom: 1px dotted #999; width: 80%; margin: 40px auto 10px auto; }

        /* ‡∏õ‡∏∏‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå */
        .btn-print {
            position: fixed; top: 20px; right: 20px;
            padding: 12px 24px; background: #0d6efd; color: white;
            border: none; cursor: pointer; border-radius: 50px; 
            font-size: 16px; text-decoration: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            font-weight: bold; z-index: 1000;
        }
        .btn-print:hover { background: #0b5ed7; transform: translateY(-2px); }

        /* Media Print */
        @media print {
            body { background: white; margin: 0; padding: 0; }
            .page { margin: 0; padding: 20mm; box-shadow: none; width: auto; height: auto; }
            .no-print { display: none !important; }
        }
    </style>
</head>
<body>

    <a href="javascript:window.print()" class="btn-print no-print">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</a>

    <div class="page">
        <div class="header">
            <div class="company-info">
                {% if company.logo %}
                    <img src="{{ company.logo.url }}" style="height: 70px; margin-bottom: 10px;">
                {% endif %}
                <h2>{{ company.name_th|default:"‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î" }}</h2>
                <p>
                    {{ company.address|linebreaksbr }}<br>
                    <strong>‡πÇ‡∏ó‡∏£:</strong> {{ company.phone }} | 
                    <strong>Tax ID:</strong> {{ company.tax_id }}
                </p>
            </div>
            <div class="doc-title">
                <h1>‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</h1>
                <p>QUOTATION</p>
            </div>
        </div>

        <div class="info-section">
            <div class="box">
                <div style="font-weight: bold; margin-bottom: 5px; color: #0d6efd;">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (CUSTOMER)</div>
                {{ quote.customer.name }}<br>
                {{ quote.customer.address }}<br>
                <strong>‡πÇ‡∏ó‡∏£:</strong> {{ quote.customer.phone }}<br>
                <strong>‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠:</strong> {{ quote.customer.contact_person|default:"-" }}
            </div>
            <div class="box text-right">
                <p><strong>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà:</strong> {{ quote.code }}</p>
                <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong> {{ quote.date|date:"d/m/Y" }}</p>
                <p><strong>‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢:</strong> {{ quote.employee.first_name }}</p>
            </div>
        </div>

        <table class="item-table">
            <thead>
                <tr>
                    <th width="50">#</th>
                    <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (Description)</th>
                    <th width="80">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                    <th width="100">‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                    <th width="120">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
                </tr>
            </thead>
            <tbody>
                {% for item in items %}
                <tr>
                    <td class="text-center">{{ forloop.counter }}</td>
                    <td>{{ item.product.name }}</td>
                    <td class="text-center">{{ item.quantity }}</td>
                    <td class="text-right">{{ item.unit_price|floatformat:2|intcomma }}</td>
                    <td class="text-right">{{ item.amount|floatformat:2|intcomma }}</td>
                </tr>
                {% endfor %}
                
                {% for i in "12345" %}
                <tr><td colspan="5" style="height: 30px;"></td></tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="total-section">
            <div class="total-box">
                <div class="total-row">
                    <span>‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (Subtotal):</span>
                    <span>{{ quote.subtotal|floatformat:2|intcomma }}</span>
                </div>
                {% if quote.discount > 0 %}
                <div class="total-row text-danger">
                    <span>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (Discount):</span>
                    <span>-{{ quote.discount|floatformat:2|intcomma }}</span>
                </div>
                {% endif %}
                
                <div class="total-row grand-total">
                    <span>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô:</span>
                    <span>{{ quote.grand_total|floatformat:2|intcomma }} ‡∏ö‡∏≤‡∏ó</span>
                </div>
            </div>
        </div>

        <div class="signature-section">
            <div class="sig-box">
                <div class="sig-line"></div>
                ‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ / ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤<br>
                ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ...../...../..........
            </div>
            <div class="sig-box">
                {% if company.signature %}
                    <img src="{{ company.signature.url }}" style="height: 50px; margin-bottom: -20px;"><br>
                {% else %}
                    <div style="height: 40px;"></div>
                {% endif %}
                <div class="sig-line"></div>
                ( {{ quote.employee.first_name }} {{ quote.employee.last_name }} )<br>
                ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡∏•‡∏á‡∏ô‡∏≤‡∏°
            </div>
        </div>
    </div>

</body>
</html>