<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ {{ quote.code }}</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; background: #555; }
        
        /* ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4 */
        .page {
            width: 210mm; min-height: 297mm;
            padding: 20mm;
            margin: 10mm auto;
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            position: relative;
        }

        /* ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß */
        .header { display: flex; justify-content: space-between; margin-bottom: 20px; }
        .company-info h2 { margin: 0; color: #333; }
        .doc-title { text-align: right; }
        .doc-title h1 { margin: 0; color: #0d6efd; text-transform: uppercase; }
        
        /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ */
        .info-section { display: flex; justify-content: space-between; margin-bottom: 20px; border-bottom: 2px solid #ddd; padding-bottom: 20px; }
        .box { width: 48%; }
        .box strong { display: block; margin-bottom: 5px; font-size: 1.1em; }

        /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ */
        .item-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        .item-table th, .item-table td { border: 1px solid #ccc; padding: 8px; }
        .item-table th { background: #f8f9fa; text-align: center; }
        .text-right { text-align: right; }
        .text-center { text-align: center; }

        /* ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡πâ‡∏≤‡∏¢ */
        .total-section { display: flex; justify-content: flex-end; }
        .total-box { width: 40%; }
        .total-row { display: flex; justify-content: space-between; padding: 5px 0; }
        .grand-total { font-weight: bold; font-size: 1.2em; border-top: 2px solid #333; border-bottom: 2px solid #333; margin-top: 5px; padding: 10px 0; }

        .signature-section { display: flex; justify-content: space-between; margin-top: 50px; text-align: center; }
        .sig-box { width: 40%; border-top: 1px solid #ccc; padding-top: 10px; }

        /* ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏±‡πà‡∏á Print ‡∏à‡∏£‡∏¥‡∏á */
        @media print {
            body { background: white; margin: 0; }
            .page { margin: 0; box-shadow: none; width: auto; height: auto; }
            .no-print { display: none; }
        }
        
        /* ‡∏õ‡∏∏‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå */
        .btn-print {
            position: fixed; top: 20px; right: 20px;
            padding: 10px 20px; background: #0d6efd; color: white;
            border: none; cursor: pointer; border-radius: 5px; font-size: 16px;
            text-decoration: none;
        }
    </style>
</head>
<body>

    <a href="javascript:window.print()" class="btn-print no-print">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</a>

    <div class="page">
        <div class="header">
            <div class="company-info">
                {% if company.logo %}
                    <img src="{{ company.logo.url }}" style="height: 60px; margin-bottom: 10px;">
                {% endif %}
                <h2>{{ company.name_th|default:"‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î" }}</h2>
                <p style="font-size: 0.9em; color: #666;">
                    {{ company.address|linebreaksbr }}<br>
                    ‡πÇ‡∏ó‡∏£: {{ company.phone }} | ‡πÄ‡∏•‡∏Ç‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ: {{ company.tax_id }}
                </p>
            </div>
            <div class="doc-title">
                <h1>‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</h1>
                <p style="letter-spacing: 2px;">QUOTATION</p>
            </div>
        </div>

        <div class="info-section">
            <div class="box">
                <strong>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (Customer):</strong>
                {{ quote.customer.name }}<br>
                {{ quote.customer.address }}<br>
                ‡πÇ‡∏ó‡∏£: {{ quote.customer.phone }} <br>
                ‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠: {{ quote.customer.contact_person }}
            </div>
            <div class="box text-right">
                <p><strong>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà (No):</strong> {{ quote.code }}</p>
                <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (Date):</strong> {{ quote.date|date:"d/m/Y" }}</p>
                <p><strong>‡∏ú‡∏π‡πâ‡∏≠‡∏≠‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£:</strong> {{ quote.employee.first_name }}</p>
            </div>
        </div>

        <table class="item-table">
            <thead>
                <tr>
                    <th width="50">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                    <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                    <th width="80">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                    <th width="100">‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                    <th width="120">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
                </tr>
            </thead>
            <tbody>
                {% for item in items %}
                <tr>
                    <td class="text-center">{{ forloop.counter }}</td>
                    <td>{{ item.product.name }}</td>
                    <td class="text-center">{{ item.quantity }}</td>
                    <td class="text-right">{{ item.unit_price|floatformat:2 }}</td>
                    <td class="text-right">{{ item.amount|floatformat:2 }}</td>
                </tr>
                {% endfor %}
                
                {% for i in "12345" %}
                <tr><td colspan="5" style="height: 25px;"></td></tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="total-section">
            <div class="total-box">
                <div class="total-row">
                    <span>‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (Subtotal):</span>
                    <span>{{ quote.subtotal|floatformat:2 }}</span>
                </div>
                <div class="total-row">
                    <span>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (Discount):</span>
                    <span>{{ quote.discount|floatformat:2 }}</span>
                </div>
                <div class="total-row grand-total">
                    <span>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô:</span>
                    <span>{{ quote.grand_total|floatformat:2 }} ‡∏ö‡∏≤‡∏ó</span>
                </div>
            </div>
        </div>

        <div class="signature-section">
            <div class="sig-box">
                <br><br>
                (....................................................)<br>
                ‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ / ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤<br>
                ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ...../...../..........
            </div>
            <div class="sig-box">
                {% if company.signature %}
                    <img src="{{ company.signature.url }}" style="height: 50px;"><br>
                {% else %}
                    <br><br>
                {% endif %}
                ( {{ quote.employee.first_name }} {{ quote.employee.last_name }} )<br>
                ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡∏•‡∏á‡∏ô‡∏≤‡∏°<br>
                ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà {{ quote.date|date:"d/m/Y" }}
            </div>
        </div>
    </div>

</body>
</html>